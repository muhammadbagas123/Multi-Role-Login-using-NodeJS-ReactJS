"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deleteUser=exports.updateUser=exports.createUser=exports.getUsertById=exports.getUsers=void 0;var _UserModel=_interopRequireDefault(require("../model/UserModel.js")),_argon=_interopRequireDefault(require("argon2"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var getUsers=function(e,r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(_UserModel.default.findAll({attributes:["uuid","name","email","role"]}));case 3:t=e.sent,r.status(200).json(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r.status(500).json({msg:e.t0.message});case 10:case"end":return e.stop()}},null,null,[[0,7]])};exports.getUsers=getUsers;var getUsertById=function(r,t){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(_UserModel.default.findOne({attributes:["uuid","name","email","role"],where:{uuid:r.params.id}}));case 3:s=e.sent,t.status(200).json(s),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.status(500).json({msg:e.t0.message});case 10:case"end":return e.stop()}},null,null,[[0,7]])};exports.getUsertById=getUsertById;var createUser=function(r,t){var s,a,n,u,o,d,c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.body,a=s.name,n=s.email,u=s.password,o=s.confPassword,d=s.role,u!==o)return e.abrupt("return",t.status(400).json({msg:"password dan confirm password tidak cocok"}));e.next=3;break;case 3:return e.next=5,regeneratorRuntime.awrap(_argon.default.hash(u));case 5:return c=e.sent,e.prev=6,e.next=9,regeneratorRuntime.awrap(_UserModel.default.create({name:a,email:n,password:c,role:d}));case 9:t.status(201).json({msg:"register berhasil"}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),t.status(400).json({msg:e.t0.message});case 15:case"end":return e.stop()}},null,null,[[6,12]])};exports.createUser=createUser;var updateUser=function(r,t){var s,a,n,u,o,d,c,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(_UserModel.default.findOne({where:{uuid:r.params.id}}));case 2:if(s=e.sent){e.next=5;break}return e.abrupt("return",t.status(404).json({msg:"User tidak ditemukan"}));case 5:if(a=r.body,n=a.name,u=a.email,o=a.password,d=a.confPassword,c=a.role,""!==o&&null!==o){e.next=10;break}i=s.password,e.next=13;break;case 10:return e.next=12,regeneratorRuntime.awrap(_argon.default.hash(o));case 12:i=e.sent;case 13:if(o!==d)return e.abrupt("return",t.status(400).json({msg:"password dan confirm password tidak cocok"}));e.next=15;break;case 15:return e.prev=15,e.next=18,regeneratorRuntime.awrap(_UserModel.default.update({name:n,email:u,password:i,role:c},{where:{id:s.id}}));case 18:t.status(200).json({msg:"User Updated"}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(15),t.status(400).json({msg:e.t0.message});case 24:case"end":return e.stop()}},null,null,[[15,21]])};exports.updateUser=updateUser;var deleteUser=function(r,t){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(_UserModel.default.findOne({where:{uuid:r.params.id}}));case 2:if(s=e.sent){e.next=5;break}return e.abrupt("return",t.status(404).json({msg:"User tidak ditemukan"}));case 5:return e.prev=5,e.next=8,regeneratorRuntime.awrap(_UserModel.default.destroy({where:{id:s.id}}));case 8:t.status(200).json({msg:"User Deleted"}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),t.status(400).json({msg:e.t0.message});case 14:case"end":return e.stop()}},null,null,[[5,11]])};exports.deleteUser=deleteUser;
//# sourceMappingURL=Users.min.js.map
