{"version":3,"sources":["AuthUser.js"],"names":["verifyUser","req","res","next","session","userId","status","json","msg","User","findOne","where","uuid","user","id","role","adminOnly"],"mappings":";;;;;;;AAAA;;;;AAEO,IAAMA,UAAU,GAAG,SAAbA,UAAa,CAAMC,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAClBF,GAAG,CAACG,OAAJ,CAAYC,MADM;AAAA;AAAA;AAAA;;AAAA,2CAEXH,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,YAAAA,GAAG,EAAE;AAAN,WAArB,CAFW;;AAAA;AAAA;AAAA,0CAIHC,sBAAKC,OAAL,CAAa;AAC5BC,YAAAA,KAAK,EAAE;AACHC,cAAAA,IAAI,EAAEX,GAAG,CAACG,OAAJ,CAAYC;AADf;AADqB,WAAb,CAJG;;AAAA;AAIhBQ,UAAAA,IAJgB;;AAAA,cASlBA,IATkB;AAAA;AAAA;AAAA;;AAAA,2CASLX,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,YAAAA,GAAG,EAAE;AAAN,WAArB,CATK;;AAAA;AAUtBP,UAAAA,GAAG,CAACI,MAAJ,GAAaQ,IAAI,CAACC,EAAlB;AACAb,UAAAA,GAAG,CAACc,IAAJ,GAAWF,IAAI,CAACE,IAAhB;AACAZ,UAAAA,IAAI;;AAZkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAnB;;;;AAeA,IAAMa,SAAS,GAAG,SAAZA,SAAY,CAAMf,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CACFM,sBAAKC,OAAL,CAAa;AAC5BC,YAAAA,KAAK,EAAE;AACHC,cAAAA,IAAI,EAAEX,GAAG,CAACG,OAAJ,CAAYC;AADf;AADqB,WAAb,CADE;;AAAA;AACfQ,UAAAA,IADe;;AAAA,cAMjBA,IANiB;AAAA;AAAA;AAAA;;AAAA,4CAMJX,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,YAAAA,GAAG,EAAE;AAAN,WAArB,CANI;;AAAA;AAAA,gBAOlBK,IAAI,CAACE,IAAL,KAAc,OAPI;AAAA;AAAA;AAAA;;AAAA,4CAOYb,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAACC,YAAAA,GAAG,EAAE;AAAN,WAArB,CAPZ;;AAAA;AAQrBL,UAAAA,IAAI;;AARiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAlB","sourcesContent":["import User from \"../model/UserModel.js\";\r\n\r\nexport const verifyUser = async(req, res, next) =>{\r\n    if(!req.session.userId){\r\n        return res.status(401).json({msg: \"Mohon login ke akun Anda!\"});\r\n    }\r\n    const user = await User.findOne({\r\n        where: {\r\n            uuid: req.session.userId\r\n        }\r\n    });\r\n    if(!user) return res.status(404).json({msg: \"User tidak ditemukan\"});\r\n    req.userId = user.id;\r\n    req.role = user.role;\r\n    next();\r\n}\r\n\r\nexport const adminOnly = async(req, res, next) =>{\r\n    const user = await User.findOne({\r\n        where: {\r\n            uuid: req.session.userId\r\n        }\r\n    });\r\n    if(!user) return res.status(404).json({msg: \"User tidak ditemukan\"});\r\n    if(user.role !== \"admin\") return res.status(403).json({msg: \"Akses terlarang\"});\r\n    next();\r\n}"],"file":"AuthUser.dev.js"}