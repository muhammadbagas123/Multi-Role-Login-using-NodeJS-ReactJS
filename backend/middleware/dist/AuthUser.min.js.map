{"version":3,"sources":["AuthUser.js"],"names":["_UserModel","_interopRequireDefault","require","verifyUser","req","res","next","user","regeneratorRuntime","async","_context","prev","session","userId","abrupt","status","json","msg","awrap","User","findOne","where","uuid","sent","id","role","stop","adminOnly","_context2"],"mappings":"gHAAA,IAAAA,WAAAC,uBAAAC,QAAA,kGAEO,IAAMC,WAAa,SAAMC,EAAKC,EAAKC,GAAhB,IAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAJ,MAAA,KAAA,EAAA,GAClBF,EAAIQ,QAAQC,OADM,CAAAH,EAAAJ,KAAA,EAAA,MAAA,OAAAI,EAAAI,OAAA,SAEXT,EAAIU,OAAO,KAAKC,KAAK,CAACC,IAAK,+BAFhB,KAAA,EAAA,OAAAP,EAAAJ,KAAA,EAAAE,mBAAAU,MAIHC,WAAAA,QAAKC,QAAQ,CANpCC,MAAA,CAQYC,KAAMlB,EAAIQ,QAAQC,WANJ,KAAA,EAAA,GAIhBN,EAJgBG,EAAAa,KAAA,CAAAb,EAAAJ,KAAA,EAAA,MAAA,OAAAI,EAAAI,OAAA,SAAAT,EAAAU,OAAbZ,KAAmBC,KAAKC,CAAAA,IAAKC,0BAAhB,KAAA,EAAAF,EAAAS,OAAAN,EAAAiB,GAAApB,EAAAqB,KAAAlB,EAAAkB,KAAAnB,IAAA,KAAA,GAAA,IAAA,MAAA,OAAAI,EAAAgB,yCAAA,IAAAC,UAClB,SAAYd,EADMR,EAAAC,GAClB,IAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAmB,GAAA,OAAA,OAAAA,EAAAjB,KAAAiB,EAAAtB,MAAA,KAAA,EAAA,OAAAsB,EAAAtB,KAAA,EAAAE,mBAAAU,MADkBC,WAAAA,QAAAC,QAAA,CAAAC,MAAA,CAAAC,KAAAlB,EAAAQ,QAAAC,WAClB,KAAA,EAAA,GADkBN,EAClBqB,EAAAL,KAAA,CAAAK,EAAAtB,KAAA,EAAA,MAAA,OAAAsB,EAAAd,OAAA,SACkCT,EAAAU,OAAA,KAAAC,KAAA,CAAAC,IAAA,0BADlC,KAAA,EAAA,GADkB,UAEUV,EAFVkB,KAClB,OAAAG,EAAAd,OAAA,SADkBT,EAAAU,OAAA,KAAAC,KAAA,CAAAC,IAAA,qBAClBW,EAAAtB,KAAA,EAAA,MAAA,KAAA,EAsBJA,IAtBI,KAAA,EAAA,IAAA,MAAA,OAAAsB,EAAAF","file":"AuthUser.min.js","sourcesContent":["import User from \"../model/UserModel.js\";\r\n\r\nexport const verifyUser = async(req, res, next) =>{\r\n    if(!req.session.userId){\r\n        return res.status(401).json({msg: \"Mohon login ke akun Anda!\"});\r\n    }\r\n    const user = await User.findOne({\r\n        where: {\r\n            uuid: req.session.userId\r\n        }\r\n    });\r\n    if(!user) return res.status(404).json({msg: \"User tidak ditemukan\"});\r\n    req.userId = user.id;\r\n    req.role = user.role;\r\n    next();\r\n}\r\n\r\nexport const adminOnly = async(req, res, next) =>{\r\n    const user = await User.findOne({\r\n        where: {\r\n            uuid: req.session.userId\r\n        }\r\n    });\r\n    if(!user) return res.status(404).json({msg: \"User tidak ditemukan\"});\r\n    if(user.role !== \"admin\") return res.status(403).json({msg: \"Akses terlarang\"});\r\n    next();\r\n}"]}